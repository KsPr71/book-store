[build]
  command = "NETLIFY=true npm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "20"
  NETLIFY = "true"
  # Deshabilitar PWA en Netlify si causa problemas
  DISABLE_PWA = "false"
  # Excluir variables NEXT_PUBLIC_* del escaneo de secretos (son públicas por diseño)
  SECRETS_SCAN_OMIT_KEYS = "NEXT_PUBLIC_SUPABASE_URL,NEXT_PUBLIC_SUPABASE_ANON_KEY,NEXT_PUBLIC_VAPID_PUBLIC_KEY"

# Configuración para Next.js
[[plugins]]
  package = "@netlify/plugin-nextjs"

# Configuración de funciones serverless
[functions]
  node_bundler = "esbuild"
  # Incluir node_modules necesarios
  included_files = ["node_modules/web-push/**"]

